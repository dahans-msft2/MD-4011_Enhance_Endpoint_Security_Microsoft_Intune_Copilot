# Demo F: Security Copilot Incident Investigation (Capstone)

**Module**: Module 6 - Investigate and respond with Security Copilot  
**Duration**: 15-18 minutes  
**Difficulty**: Advanced  
**Demo Type**: Instructor-led capstone demonstration

## Learning Objectives

After this demonstration, learners will understand how to:
- Investigate security incidents using Security Copilot in Defender portal
- Use natural language prompts to extract threat intelligence
- Analyze suspicious scripts with AI-powered decoding
- Troubleshoot device compliance issues using Copilot in Intune
- Generate investigation reports for technical and executive audiences
- Apply AI-powered security operations to real-world scenarios

## Prerequisites

### Instructor Requirements
- Security Administrator, Intune Administrator, and Security Copilot Contributor roles
- Completion of all previous demos (Demos A-E)
- Familiarity with Module 6 content

### Environment Requirements
- Microsoft Security Copilot license with SCUs provisioned (minimum 1 SCU)
- Windows device enrolled in Intune and onboarded to Defender
- Active Defender for Endpoint alerts (or ability to simulate)
- Defender and Intune plugins enabled in Security Copilot

### Licenses Required
- Microsoft 365 E5 or standalone Security Copilot with SCU capacity

## Demo Scenario

**Context**: Contoso Healthcare's SOC detected a high-severity alert: Suspicious PowerShell activity on a Finance department device suggesting credential theft attempt. Alex, a junior security analyst, needs to investigate quickly but has limited experience with advanced threats.

**Narrative**: "This is a real-world scenario security teams face daily: High-severity alert, time pressure, and need for fast, accurate investigation. Security Copilot empowers Alex to investigate at expert level using natural language, cutting investigation time from hours to minutes. Let's watch Alex use Copilot to investigate, contain, and report on this incident."

## Step-by-Step Instructions

### Part 1: Investigate incident with Copilot in Defender (6-7 minutes)

#### Step 1.1: Access incident and view Copilot summary

**Action**: Open incident in Defender portal

1. Navigate to **https://security.microsoft.com**
2. Go to **Incidents & alerts** → **Incidents**
3. Select a high-severity incident (or create simulated incident):
   - Example: "Suspicious PowerShell execution detected on DESKTOP-FIN01"
   - Severity: High
   - Status: New or In progress
4. Click on incident to open details page
5. **Copilot** pane should automatically open on the right side
6. If not, click **Copilot** button in top-right toolbar
7. Review automatic incident summary generated by Copilot:
   - Attack type (e.g., "Potential credential theft using PowerShell-based tools")
   - Timeline of events
   - Affected devices and users
   - MITRE ATT&CK techniques (e.g., T1003 - Credential Dumping)
   - Recommended actions

**Talking points**:
- "Copilot summarizes incident immediately - no manual log review needed"
- "Summary includes attack type, timeline, affected assets, and recommendations"
- "This would normally take 30 minutes of manual investigation"
- "Even junior analysts get expert-level context instantly"
- "MITRE ATT&CK classification helps understand attacker techniques"

**TODO**: Screenshot of incident with Copilot summary visible

#### Step 1.2: Ask clarifying questions with natural language

**Action**: Use prompts to dig deeper

1. In Copilot prompt bar at bottom, type: **"What PowerShell commands were executed on the affected device?"**
2. Press Enter and wait for Copilot response (5-10 seconds)
3. Review response showing decoded PowerShell commands
4. Ask follow-up: **"Is the IP address 185.220.101.45 known malicious?"**
5. Copilot queries threat intelligence and responds with IP reputation, associated threat actors, and IOCs
6. Ask: **"What MITRE ATT&CK techniques were used in this attack?"**
7. Copilot lists techniques:
   - T1059.001 - PowerShell execution
   - T1003.001 - LSASS memory dumping
   - T1021 - Lateral movement attempts

**Talking points**:
- "Natural language questions - no need to learn complex query languages"
- "Copilot searches across alerts, logs, threat intel, and correlates automatically"
- "IP reputation check would normally require manual threat intel lookup"
- "MITRE ATT&CK mapping helps understand attack kill chain"
- "Each answer leads to better questions - conversational investigation"

**TODO**: Screenshot of PowerShell command question and response
**TODO**: Screenshot of threat intel lookup response

#### Step 1.3: Analyze suspicious script

**Action**: Decode and explain malicious script

1. In the incident timeline, find alert related to PowerShell execution
2. Click **Analyze script** button (or ask Copilot: **"Analyze the PowerShell script from this alert"**)
3. Copilot displays:
   - **Decoded script**: Human-readable version of obfuscated code
   - **Script purpose**: "Attempts to dump credentials from LSASS process memory"
   - **Malicious behaviors**: Memory access, process injection, encoding/decoding
   - **Verdict**: Malicious
   - **IOCs**: File hashes, command patterns, registry keys
4. Review script analysis in plain English

**Talking points**:
- "Script analysis used to require malware reverse engineering skills"
- "Copilot decodes obfuscation, explains purpose, and identifies malicious behaviors"
- "Verdict is clear: Malicious vs. Suspicious vs. Benign"
- "IOCs can be used to hunt for similar threats across environment"
- "This analysis takes Copilot 10 seconds vs. 30 minutes for skilled analyst"

**TODO**: Screenshot of script analysis with decoded script and verdict

#### Step 1.4: Review guided response recommendations

**Action**: Get remediation guidance

1. In Copilot panel, locate **Guided response** section
2. Review recommended actions:
   - ✅ Isolate affected device from network
   - ✅ Reset passwords for users active on device during attack
   - ✅ Run full antivirus scan
   - ✅ Remove persistence mechanisms (scheduled tasks, startup programs)
   - ✅ Block malicious file hashes across environment
   - ✅ Monitor for lateral movement to other devices
3. Click **Isolate device** (or demonstrate in UI without actually isolating if live demo)

**Talking points**:
- "Guided response provides step-by-step remediation actions"
- "Actions are tailored to attack type - malware gets different guidance than credential theft"
- "Reduces decision fatigue - analysts know exactly what to do"
- "Actions can be taken directly from Copilot - one-click remediation"
- "This guidance ensures consistent response across all analysts"

**TODO**: Screenshot of guided response recommendations

---

### Part 2: Troubleshoot device with Copilot in Intune (4-5 minutes)

#### Step 2.1: Switch to Intune and get device summary

**Action**: Investigate device configuration

1. Open new tab and navigate to **https://intune.microsoft.com**
2. Go to **Devices** → **All devices**
3. Search for affected device (e.g., DESKTOP-FIN01)
4. Click on device to open details page
5. Click **Copilot** button in top-right toolbar
6. Review automatic device summary:
   - Device name, OS version, last sync
   - **Management state**: Compliant or Noncompliant
   - **Compliance issues**: (e.g., "BitLocker encryption not enabled, Password complexity failed")
   - **Installed apps**: Microsoft 365 Apps, Teams, etc.
   - **Group memberships**: All Windows Devices, Finance-Devices
   - **Applied policies**: Windows 11 Security Baseline, BitLocker policy

**Talking points**:
- "Device might be vulnerable if noncompliant with security policies"
- "Copilot gives instant overview - no need to click through multiple tabs"
- "Compliance issues explain why device was susceptible to attack"
- "Group memberships show which policies SHOULD apply"

**TODO**: Screenshot of Copilot device summary in Intune

#### Step 2.2: Diagnose compliance failure

**Action**: Understand why device is noncompliant

1. In Copilot prompt, ask: **"Why is this device noncompliant?"**
2. Copilot response explains:
   - **Root cause**: BitLocker encryption policy not enforced
   - **Reason**: Group Policy conflict overrides Intune policy
   - **Impact**: Device doesn't meet compliance requirements, blocked from accessing corporate resources via conditional access
3. Ask: **"How do I fix the BitLocker compliance issue?"**
4. Copilot provides remediation steps:
   1. Check for conflicting Group Policy Objects (GPOs)
   2. Ensure user has admin rights for BitLocker enablement
   3. Manually enable BitLocker or force policy sync
   4. Verify compliance policy settings match device capabilities

**Talking points**:
- "Compliance failures often have complex root causes - policy conflicts, device limitations, user permissions"
- "Copilot explains the 'why' in plain English, not just 'policy failed'"
- "Remediation steps are actionable - IT can fix immediately"
- "This saves 20-30 minutes of troubleshooting per device"

**TODO**: Screenshot of compliance failure explanation

#### Step 2.3: Compare with compliant device

**Action**: Identify configuration differences

1. Ask Copilot: **"Compare this device to DESKTOP-IT05 (a known-compliant device)"**
2. Copilot shows side-by-side comparison:
   - **DESKTOP-FIN01** (noncompliant):
     - BitLocker: Not enabled
     - Windows Security Baseline: Partially applied (72 of 103 settings)
     - ASR rule (LSASS protection): Audit mode
   - **DESKTOP-IT05** (compliant):
     - BitLocker: Enabled
     - Windows Security Baseline: Fully applied (103 of 103 settings)
     - ASR rule (LSASS protection): Block mode
3. Copilot highlights key differences and explains security impact

**Talking points**:
- "Comparison quickly identifies what's different between working and broken devices"
- "Notice: ASR LSASS protection was in Audit, not Block - allowed credential theft attack"
- "This is exactly why device was vulnerable to the credential dumping attack"
- "Comparison feature saves enormous troubleshooting time"

**TODO**: Screenshot of device comparison showing configuration differences

---

### Part 3: Generate investigation report (3-4 minutes)

#### Step 3.1: Create technical report

**Action**: Generate SOC team report

1. Return to Defender portal incident page
2. In Copilot prompt, type: **"Generate a detailed technical report for this incident"**
3. Copilot produces comprehensive report including:
   - **Incident summary**: Attack type, timeline, severity
   - **Affected assets**: Devices (DESKTOP-FIN01), Users (AlexW@contoso.com)
   - **Attack details**: PowerShell commands, LSASS access attempts, IOCs
   - **Root cause analysis**: ASR rule not in Block mode, BitLocker not enabled
   - **Response actions taken**: Device isolated, passwords reset, file hashes blocked
   - **Recommendations for prevention**: Enable ASR Block mode, enforce BitLocker compliance, deploy Credential Guard

**Talking points**:
- "Technical report contains all details SOC team needs"
- "Includes timeline, IOCs, affected assets, response actions"
- "Can be exported and shared with team or saved to case management system"
- "Report generation takes 30 seconds vs. 45 minutes manual documentation"

**TODO**: Screenshot of technical investigation report

#### Step 3.2: Create executive summary

**Action**: Generate report for leadership

1. In Copilot, ask: **"Create an executive summary of this incident for the CISO"**
2. Copilot generates business-focused summary:
   - **What happened**: "Attempted credential theft on Finance department device using PowerShell-based attack tools"
   - **Impact**: "Attack was detected and blocked. No credentials stolen. No data exfiltration. One device temporarily isolated."
   - **Response**: "Security team isolated device within 15 minutes, reset user passwords, and blocked malicious tools across environment"
   - **Prevention**: "Deploying additional security controls (Credential Guard, stricter ASR rules) to prevent future attempts"
   - **Business impact**: "Minimal disruption. User back online within 2 hours. No customer data at risk."

**Talking points**:
- "Executive summary uses business language, not technical jargon"
- "Focuses on business impact: What happened? Was data compromised? What's being done?"
- "CISO doesn't need MITRE ATT&CK details - needs business risk assessment"
- "Copilot adapts communication style to audience automatically"

**TODO**: Screenshot of executive summary report

---

### Part 4: Capstone wrap-up and lessons learned (2-3 minutes)

#### Step 4.1: Demonstrate investigation time savings

**Action**: Compare traditional vs. Copilot investigation

**Show on slide or whiteboard**:

| Investigation Step | Traditional Time | With Copilot | Time Saved |
|-------------------|------------------|--------------|------------|
| Initial alert triage | 15-30 min | 2-3 min | 85% |
| Threat intelligence lookup | 20-30 min | 10 sec | 98% |
| Script analysis | 30-45 min | 10 sec | 99% |
| Device compliance check | 15-20 min | 2 min | 90% |
| Documentation & reporting | 30-45 min | 30 sec | 99% |
| **Total** | **2-3 hours** | **15-20 min** | **85% overall** |

**Talking points**:
- "Copilot reduces investigation from 2-3 hours to 15-20 minutes - 85% time savings"
- "Junior analysts perform at senior analyst level with AI assistance"
- "SOC teams can handle 3x more incidents with same headcount"
- "More time for proactive threat hunting, less time on repetitive investigation tasks"

#### Step 4.2: Key takeaways and course conclusion

**Action**: Summarize course journey

**Recap the complete endpoint management and security journey**:

1. **Module 1**: Prepared tenant, assigned licenses, configured automatic enrollment
2. **Module 2**: Enrolled devices in Intune, validated in Entra and Intune portals
3. **Module 3**: Applied configuration profiles and compliance policies with dynamic groups
4. **Module 4**: Protected data with MAM policies and enforced compliance with conditional access
5. **Module 5**: Hardened devices with security baselines, onboarded to Defender, enabled ASR rules
6. **Module 6**: Investigated and responded to threats with AI-powered Security Copilot

**Final message**:
"You've now mastered the complete modern endpoint management and security lifecycle with Microsoft Intune, Defender for Endpoint, and Security Copilot. From enrolling devices to investigating advanced threats with AI, you have the skills to deploy, manage, secure, and monitor endpoints at scale. Contoso Healthcare went from inconsistent, insecure device management to a modern, AI-powered security operations model. Your organization can achieve the same transformation. Thank you for completing MD-4011!"

---

## Demo Summary

**Recap key steps**:
1. ✅ Investigated high-severity incident using Copilot automatic summaries
2. ✅ Asked natural language questions to extract threat intelligence and understand attack
3. ✅ Analyzed suspicious PowerShell script with AI-powered decoding
4. ✅ Reviewed guided response recommendations and contained threat
5. ✅ Troubleshot device compliance issues in Intune with Copilot device summary and comparison
6. ✅ Generated technical and executive investigation reports tailored to audiences
7. ✅ Demonstrated 85% time savings and analyst empowerment with AI

**Key takeaways**:
- "Security Copilot democratizes expert-level security operations for all skill levels"
- "Natural language interface eliminates need to learn complex query languages"
- "Integration across Defender and Intune provides complete incident context"
- "AI-powered script analysis, threat intelligence, and guidance accelerate response"
- "85% investigation time reduction enables SOC teams to handle more threats faster"
- "Automated reporting ensures consistent documentation and communication"

**Course completion message**:
"Congratulations on completing MD-4011! You've journeyed from basic device enrollment to AI-powered security operations. You now have the knowledge and skills to transform your organization's endpoint management and security with Microsoft Intune, Defender for Endpoint, and Security Copilot."

---

## Common Issues and Troubleshooting

### Issue: Copilot button not visible in Defender or Intune portal
**Cause**: Security Copilot not provisioned, insufficient permissions, or plugins not enabled  
**Solution**: 
- Verify Security Copilot license and SCUs are provisioned
- Check user has Security Reader or Security Administrator role
- Enable Defender and Intune plugins: Security Copilot portal → Plugins → Enable

### Issue: Copilot responses are generic or unhelpful
**Cause**: Vague prompts, insufficient context, or data not available  
**Solution**: 
- Be specific in prompts: Include device names, user names, time ranges, incident IDs
- Ensure incident has sufficient data: Some new incidents lack investigation context
- Iterate prompts: If first response unhelpful, ask clarifying follow-up questions

### Issue: Script analysis doesn't decode obfuscated script
**Cause**: Extremely complex obfuscation, or script uses unsupported techniques  
**Solution**: 
- Try rephrasing prompt: "Decode and explain this PowerShell script"
- Break script into smaller chunks if very large
- Fallback: Use manual analysis for extremely complex scripts

### Issue: Cannot generate report - Copilot says "Not enough information"
**Cause**: Incident investigation incomplete, or insufficient response actions documented  
**Solution**: 
- Complete investigation first: Answer all key questions (who, what, when, where, why)
- Document response actions: Isolation, password resets, remediation steps
- Retry report generation after more investigation context is available

---

## Additional Resources

- [Microsoft Security Copilot documentation](https://learn.microsoft.com/security-copilot/)
- [Security Copilot prompts library](https://learn.microsoft.com/security-copilot/prompts-library)
- [Investigate incidents with Copilot](https://learn.microsoft.com/security-copilot/investigate-incidents)
- [Troubleshoot devices with Copilot in Intune](https://learn.microsoft.com/mem/intune/copilot/copilot-intune-overview)
- [Create custom promptbooks](https://learn.microsoft.com/security-copilot/using-promptbooks)

---

**Demo Status**: ✅ Ready for delivery (Capstone Demo)  
**Last Updated**: November 11, 2025  
**Course**: MD-4011 - Complete
